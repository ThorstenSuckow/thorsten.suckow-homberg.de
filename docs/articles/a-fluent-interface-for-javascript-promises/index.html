<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-articles/a-fluent-interface-for-javascript-promises/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Fluent Interface for JavaScript Promises | thorsten.suckow-homberg.de</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://thorsten.suckow-homberg.de/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://thorsten.suckow-homberg.de/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://thorsten.suckow-homberg.de/docs/articles/a-fluent-interface-for-javascript-promises/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Fluent Interface for JavaScript Promises | thorsten.suckow-homberg.de"><meta data-rh="true" name="description" content="Use JavaScript Proxies to create fluent interfaces for Promises"><meta data-rh="true" property="og:description" content="Use JavaScript Proxies to create fluent interfaces for Promises"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://thorsten.suckow-homberg.de/docs/articles/a-fluent-interface-for-javascript-promises/"><link data-rh="true" rel="alternate" href="https://thorsten.suckow-homberg.de/docs/articles/a-fluent-interface-for-javascript-promises/" hreflang="en"><link data-rh="true" rel="alternate" href="https://thorsten.suckow-homberg.de/docs/articles/a-fluent-interface-for-javascript-promises/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YP7SUYRV93-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="thorsten.suckow-homberg.de RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="thorsten.suckow-homberg.de Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="thorsten.suckow-homberg.de" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.5204c750.css">
<link rel="preload" href="/assets/js/runtime~main.c73620db.js" as="script">
<link rel="preload" href="/assets/js/main.de22530c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/home.svg" alt="Home" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/home.svg" alt="Home" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/articles/">Articles</a><a class="navbar__item navbar__link" href="/docs/toolbox">Toolbox</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">About</a><a href="https://github.com/thorstensuckow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/articles/">Articles</a><button aria-label="Toggle the collapsible sidebar category &#x27;Articles&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/software-craftsmanship/">On Software Craftsmanship</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/docs/articles/agp-the-payroll-system/introduction">The Payroll System</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Payroll System&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/agp-the-payroll-system/Use-Case-1-Adding-a-new-employee">Use Case 1 - Adding a new employee</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/dependency-injection-in-javascript/">Dependency Injection in JavaScript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/sencha-extjs-beyond-es5/">Ext JS - Beyond ES5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/using-php-enums-as-method-calls/">Using PHP enums as method calls</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/downloadable-assets-with-github-actions/">Downloadable Assets with GitHub Actions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/docs/articles/creating-extjs-applications-with-coon-js/">Creating ExtJS applications with coon.js</a><button aria-label="Toggle the collapsible sidebar category &#x27;Creating ExtJS applications with coon.js&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/creating-extjs-applications-with-coon-js/introduction">Part 1: Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/creating-extjs-applications-with-coon-js/packages-and-configuration-options">Part 2: Packages and Configuration Options</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/creating-extjs-applications-with-coon-js/configuration-details-and-plugins">Part 3: Configuration Details and defining Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/creating-extjs-applications-with-coon-js/registering-services-and-using-the-service-locator">Part 4: Registering services and using the Service Locator</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/articles/javascript-promises-return-values-and-error-handlers/">JavaScript Promises — Return Values and Error Handlers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/articles/a-fluent-interface-for-javascript-promises/">Fluent Interface for JavaScript Promises</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/articles/"><span itemprop="name">Articles</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Fluent Interface for JavaScript Promises</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Fluent Interface for JavaScript Promises</h1></header><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><div>This article was originally published in <!-- -->October 2021<!-- --> at <a target="_blank" href="https://medium.com/@thorstensuckow/a-fluent-interface-for-javascript-promises-372ffc40e051">medium.com</a>. Some formatting might have get lost during the migration to this site: If you think you spotted an issue caused by malformed formatting, please <a href="mailto:thorsten@suckow-homberg.de">let me know</a>.</div></div></div><p>A Fluent Interface is an OOP API using method chaining to increase code legibility. This article explains how to transform JavaScript Promises into more readable code blocks without the constant use of <code>then()</code>.</p><p>We’ll be seeing the term <strong>Promise</strong> in this article quite often. Here’s what it means:</p><blockquote><p><em>A JavaScript Promise represents the eventual completion (or failure) of an asnychronous operation. (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener noreferrer">MDN</a>)</em></p></blockquote><p>The <strong>Promise</strong>-API is part of JavaScript since the <a href="https://262.ecma-international.org/6.0/" target="_blank" rel="noopener noreferrer">6th Edition of ECMAScript</a>, better known as <strong>ECMAScript 2015</strong> or <strong>ES6</strong>. There are a lot of articles introducing the API, so I do not want to go into too much detail about it here: But if you feel like you need to catch up on things, I recommend reading through the following:</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener noreferrer">The Promise Object (MDN)</a></li><li><a href="https://betterprogramming.pub/understanding-promises-in-javascript-13d99df067c1" target="_blank" rel="noopener noreferrer">Understanding Promises in JavaScript</a></li><li><a href="https://tc39.es/ecma262/multipage/control-abstraction-objects.html#sec-promise-objects" target="_blank" rel="noopener noreferrer">ECMAScript 2022 Language Specification</a></li></ul><p><em>This article and the source code examples assume that you’re familiar with Promises.</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="know-your-tools">Know your tools<a href="#know-your-tools" class="hash-link" aria-label="Direct link to Know your tools" title="Direct link to Know your tools">​</a></h2><p>The Promise-API was something I took a deep dive in when I found myself in the process of refactoring and migrating the complete code base of my <a href="http://sencha.com" target="_blank" rel="noopener noreferrer"><strong>Sencha</strong> / <strong>ExtJS</strong></a> / JavaScript related projects (<a href="http://github.com/coon-js" target="_blank" rel="noopener noreferrer"><strong>coon.js</strong></a>, <a href="http://github.com/conjoon" target="_blank" rel="noopener noreferrer"><strong>conjoon</strong></a>, <a href="http://github.com/l8js/l8" target="_blank" rel="noopener noreferrer"><strong>l8js</strong></a>) to <a href="http://npmjs.org" target="_blank" rel="noopener noreferrer">NPM</a> in 2021. Automated dependency management is something I wish we had back in the early 2000s (hello, <a href="http://pear.php.net" target="_blank" rel="noopener noreferrer">Pear</a>!). I guess the handy work involved with web development back then is responsible for making me feel like that hotshot-knowitall-1337-hacker when I <em>i — save-dev</em> some random package nowadays. And I want my codebase to reflect the modern environment it’s used in, of course.</p><p>As with all things that gain your attention (especially if you have more important things to do; also known as <em>procrastination</em>), I got distracted by the tooling. And to ease the process of setting up browser based tests with <a href="http://bryntum.com/products/siesta" target="_blank" rel="noopener noreferrer"><strong>Siesta</strong></a> <strong>(</strong><a href="https://medium.com/u/f5a860f1d70d" target="_blank" rel="noopener noreferrer"><strong>Mats Bryntse</strong></a>, <a href="http://bryntum.com" target="_blank" rel="noopener noreferrer">Bryntum</a><strong>)</strong>, I introduced <a href="http://npmjs.org/@coon-js/siesta-lib-helper" target="_blank" rel="noopener noreferrer">@coon-js/siesta-lib-helper</a>: A NPM-package that provides <strong>easy scaffolding</strong> and <strong>reusable boilerplate-code</strong> for UI/Unit-tests for ExtJS-based projects.</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="/assets/images/siesta-5bf26dbc3a86516c4cfed26194a5416d.png" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 1</b> <span>The UI of Siesta, a JavaScript Unit and UI testing tool which can run tests in web pages or in Node.js processes. It integrates extremely well with ExtJS based projects. <a target="_blank" href="https://www.bryntum.com/products/siesta/">[Bryntum]</a></span></sup></div></div><p>If you’re familiar with Sencha and the ExtJS-framework, you will know that setting up the environment for UI tests can be quite a hassle when using the classic- and/or modern-toolkit, especially since Sencha does not provide dependency management in a way you’d expect from an <a href="https://www.sencha.com/blog/enterprise-in-the-era-of-ext-js-7-x/" target="_blank" rel="noopener noreferrer">enterprise-ready JavaScript framework</a> in 2021. But once you&#x27;ve grown accustomed to the pattern of writing tests for it you get a feeling for what needs to be put where for creating a functional testing environment with the right tools…</p><blockquote><p><em>While a more robust product comes with more to learn, once you know it, productivity increases rapidly. (<a href="https://www.sencha.com/blog/enterprise-in-the-era-of-ext-js-7-x/" target="_blank" rel="noopener noreferrer">Sencha</a>)</em></p></blockquote><p>To get to the point: I wanted my browser based test suites to be magically bootstrapped, and this magic should get profanely applied by an automated process. Sometimes, magic needs to happen asynchronously, so the code had to use Promises (what else than a mere promise would a wish involving magic be?).</p><p>And while this approach eliminated almost completely the tedious re-creation of callback hell, I was wondering: Is there a way of getting rid of the - then again - (pun intended) tedious task of explicitly typing <code>then</code> and passing <code>onFulfilled</code>- and <code>onRejected</code>-callbacks as arguments each time I wanted to add another asynchronous task to the Promise chain? How could I make the <strong>somewhat fluent</strong> interface <strong>more liquid</strong>?</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-1c2bb6e440226c7d85615c4ab82fe8e8"></iframe></div><div style="text-align:center"><sup><b>Source 1</b> <span>A Promise chain. Granted, arrow functions would make it more readable. Then again, a more fluent interface would make it even more readable.</span></sup></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fluent-interfaces">Fluent Interfaces<a href="#fluent-interfaces" class="hash-link" aria-label="Direct link to Fluent Interfaces" title="Direct link to Fluent Interfaces">​</a></h2><p><a href="https://martinfowler.com/" target="_blank" rel="noopener noreferrer">Martin Fowler</a> coined the term <a href="https://martinfowler.com/bliki/FluentInterface.html" target="_blank" rel="noopener noreferrer"><strong>Fluent Interface</strong></a> along with <a href="https://twitter.com/ericevans0" target="_blank" rel="noopener noreferrer">Eric Evans</a> back in 2005. On his website, he describes the concept – or design approach – fittingly with <em>the API is primarily designed to be readable and to flow</em>. And while fluent interfaces were not invented by Evans nor Fowler, they took care of proper naming and describing the concept to the world.</p><blockquote><p><em>The API is primarily designed to be readable and to flow. (Martin Fowler)</em></p></blockquote><p>A fluent interface is a <strong>speakable API</strong>, and I think most of the readers have come across a fluent interface in their time as a programmer. Take for an example the following code which is part of the query builder of <a href="https://www.doctrine-project.org/projects/doctrine-orm/en/2.9/reference/query-builder.html" target="_blank" rel="noopener noreferrer"><strong>Doctrine</strong></a>:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-3a85db5f22863cbd99fd9f0561f8e167"></iframe></div><div style="text-align:center"><sup><b>Source 2</b> <span>Now that’s what we call a fluent interface!</span></sup></div></div><p>While it is totally valid to write the query like</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-c065de310b0d4948044a23dd6726235b"></iframe></div><div style="text-align:center"><sup><b>Source 3</b> <span>The same query, in a different variant.</span></sup></div></div><p>…the first example chains all the methods and does not break the flow of reading the code. While providing a fluent interface does not necessarily provide a functional benefit, it is definitely a more convenient approach for developers when investigating the sources.</p><blockquote><p><em>A fluent interface forces you to think about what kind of functionality you should break down into smaller functional pieces.</em></p></blockquote><p>One might want to differ regarding the missing functional benefit. Of course, implementing a <a href="https://en.wikipedia.org/wiki/Fluent_interface" target="_blank" rel="noopener noreferrer">fluent interface</a> forces you to think about what kind of functionality you should break down into smaller functional pieces, and therefor expose to the public API. It also adds a grammar to an API, and that helps making its usage in vendor code less error prone. <a href="https://en.wikipedia.org/wiki/Domain-specific_language" target="_blank" rel="noopener noreferrer">Domain Specific Languages</a> come to mind, and I recommend to read up on what <a href="https://martinfowler.com/books/dsl.html" target="_blank" rel="noopener noreferrer">Fowler has to say about it</a>, if you’re interested.</p><p>Now imagine writing Promise Chains like this: Instead of using <code>then()</code> as a <a href="http://learnyouahaskell.com/higher-order-functions" target="_blank" rel="noopener noreferrer"><strong>Higher Order Function</strong></a> (where we are passing the <code>onFulfilled</code>- and <code>onRejected</code>_-_callbacks  as the arguments)</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-976fb5137941b9b56e6d8021e2857f17"></iframe></div><div style="text-align:center"><sup><b>Source 4</b> <span>Another example for a promise chain, using <i>then()</i> as the higher order function it is. Note: We are gracefully and intentional omitting the onRejected-callback here.</span></sup></div></div>we want to write the code like this:<div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-03bd6c9debf2a94b4e8a24c4864370a1"></iframe></div><div style="text-align:center"><sup><b>Source 5</b> <span>Omitting then() in favor of a more readable API.</span></sup></div></div><p>That should be fairly easy, right? As of the specifications we know that <code>then()</code> returns a Promise (-object!) so we should be good with implementing <code>request()</code>, <code>anotherRequest()</code>  and <code>validateResponse()</code>as methods that itself return Promises. We should be able to chain them out of the box. Sounds reasonable. Oh, if it only was this easy…</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="en-attendant-godot">En attendant <strong>Godot</strong><a href="#en-attendant-godot" class="hash-link" aria-label="Direct link to en-attendant-godot" title="Direct link to en-attendant-godot">​</a></h2><p>Our naive assumption leads quickly to a first prototype:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-1f4243a5cf3c263413bbedad47248632"></iframe></div><div style="text-align:center"><sup><b>Source 6</b> <span>This does not look fully implemented, but it’s the best we can come up with after somef time where we’re busy with changing code, re-arranging scopes and looking up solution at stackoverflow, all this while pulling our hair out.</span></sup></div></div><p>There are quite a few problems we stumble upon with this approach. First of, we still would like the code to behave asynchronously. This is why we need to implement the <code>request()</code>-method as a Promise, so it is considered as an asynchronous operation that is <em>thenable</em> by JavaScript.</p><blockquote><p><em>If the value is a thenable (i.e. has a then()-method), the returned promise will &quot;follow&quot; that thenable, adopting its eventual state; otherwise, the returned promise will be fulfilled with the value. (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener noreferrer">MDN</a>)</em></p></blockquote><p>This is how Promises work. They return a Promise itself, indicating the state they’re in (one of <code>_pending_</code>, <code>_fulfilled_</code>, <code>_rejected_</code>). In no simple, obvious nor elegant way we’ll be able to chain one of the members of the given <code>Chain</code>-object to our initial Promise returned by <code>request()</code>.</p><p><em>“Hold on”</em>, I hear you say, <em>“I have seen how Promises return another value than a Promise”</em>. You’re somewhat right - you’re probably speaking of the value that was submitted to the resolver (first argument passed to the <em>executor</em> of the Promise), while passing that Promise to the <code>await</code> expression.</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 2</b> <span>Quick catch-up on the Promise API: The argument passed to the constructor is the so called “executor”, which in turn provides two function arguments to control the state (fulfilled, rejected) of the Promise. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">[MDN]</a></span></sup></div></div><blockquote><p><em>If a Promise is passed to an await expression, it waits for the Promise to be fulfilled and returns the fulfilled value. (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" target="_blank" rel="noopener noreferrer">MDN</a>)</em></p></blockquote><p>Let’s shed some light on this. Here’s some asynchronous code we’ll be refactoring in a second:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-6f839d2cc188e9f20b6afeca2f39e383"></iframe></div><div style="text-align:center"><sup><b>Source 7</b> <span>A typical Promise in its natural habitat. Note how we use setTimeout() to access `result`: This is required since an immediate evaluation of result would return “0”, due to the asynchronous context the code runs in.</span></sup></div></div><p>Let’s use <code>async/await</code> to fetch the return-value of the Promise inline, instead of chaining the Promise itself by using <code>then()</code>:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-f37ce8ae138075fba7a89f6f79d32dd3"></iframe></div><div style="text-align:center"><sup><b>Source 8</b> <span></span></sup></div></div><p>Enough with the excursus and back to our initial problem: Whichever way you look at at it, there is just no way to properly chain Promises in terms of “Fluent Interface” without fundamentally changing the Promise API itself. And since the Promise API is pretty much locked into the JavaScript engine, this is a no-no. If we could only somehow intercept and redefine the behavior of Promises…</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deus-ex-machina">Deus ex Machina<a href="#deus-ex-machina" class="hash-link" aria-label="Direct link to Deus ex Machina" title="Direct link to Deus ex Machina">​</a></h2><p>Design Patterns are a set of contracts among Software Developers. Their <em>terms</em> <em>and conditions</em> allow for an abstraction
of solutions to problems that come up during development, which helps tremendously when facing architectural challenges
(“architectural” not in term of DevOps, dear DevOps).</p><blockquote><p><em>In software engineering, a software design pattern is a general, reusable solution to a commonly
occurring problem within a given context in software design. (<a href="https://en.wikipedia.org/wiki/Software_design_pattern" target="_blank" rel="noopener noreferrer">Wikipedia</a>)</em></p></blockquote><p>One of the <a href="https://en.wikipedia.org/wiki/Design_Patterns#Structural" target="_blank" rel="noopener noreferrer">structural patterns</a> that Gamma,
Helm, Johnson and Vlissides describe in <a href="https://en.wikipedia.org/wiki/Design_Patterns" target="_blank" rel="noopener noreferrer">Design Patterns</a> <a href="/docs/bibliography#gof">[<span class="bibRef">📖<!-- -->GOF</span>]</a>
(junior devs, take note: that’s a reference work you need to add to your library) is the <strong>Proxy Pattern</strong>: An representative
of another object, providing the same Interface as the proxied object, making it usable in the same way. Although
both the Proxy and the target share the same interface, the implementation can differ to a huge degree: While the
target object queries a database for data, the Proxy might just return cached values, or delegate the calls to the
target, if the cache needs to be updated with actual data. Our use case differs, but in the end, this concept of
proxying an object is what we’re going to use. And luckily, it is already part of JavaScript since
<a href="https://262.ecma-international.org/6.0/#sec-proxy-objects" target="_blank" rel="noopener noreferrer">ES6</a> as a
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener noreferrer">built-in object</a>.</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="/assets/images/proxypattern-460dd5c2022a773addd558328fabbb15.png" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 3</b> <span>The UML for the Proxy Pattern. Note how Proxy and RealSubject share the same interface, and Proxy delegates the calls to RealSubject (Source: Wikipedia)</span></sup></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-proxy-in-javascript">The Proxy in JavaScript<a href="#the-proxy-in-javascript" class="hash-link" aria-label="Direct link to The Proxy in JavaScript" title="Direct link to The Proxy in JavaScript">​</a></h2><p>Creating a Proxy in JavaScript is done by calling a <strong>Proxy constructor</strong> with two arguments: The <strong>target object</strong> that should be proxied, and the <strong>handler, implementing behavior and trapping calls</strong> to the target object: The target object gets wrapped by another object — a common concept that a lot of the <a href="https://en.wikipedia.org/wiki/Structural_pattern" target="_blank" rel="noopener noreferrer">structural patterns</a> share.</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 4</b> <span>The Proxy constructor in JavaScript. It takes the target object and a handler as arguments, whereas the handler implements the behavior <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy">[MDN]</a></span></sup></div></div><p>Now you might wonder where the additional abstraction layer can be found, since we have seen that the Proxy and the target object share the same public API. After all, the Proxy must be aware of the <a href="https://en.wikipedia.org/wiki/Design_by_contract" target="_blank" rel="noopener noreferrer">contract it has to fulfill</a> to comply with the interface of the target object, right?</p><blockquote><p><em>The problem with object-oriented languages is they’ve got all this implicit environment that they carry around with them. You wanted a banana but what you got was a gorilla holding the banana and the entire jungle. (<!-- -->[Joe Armstrong]<!-- -->(<a href="https://en.wikipedia.org/wiki/Joe_Armstrong" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Joe_Armstrong</a></em>%28programmer%29))_</p></blockquote><p>Proxies in JavaScript work different: JavaScript is not a class-based OO-language - it’s missing the concept of abstract classes and interfaces. It is loosely typed and although it was invented to ride along with the hip bandwagon named <strong>Java</strong> back in the days - it somewhat <em>looks</em> like it, it sometimes <em>feels</em> like it (looking at its syntax),
but it simply is not Java.</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="/assets/images/brendaneichtwitter-74a8039dc7e8f44e8b9326cbe02ccc16.png" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 5</b> <span>You will find a lot of “like Java”-related quotes when looking at the history of JavaScript. <a target="_blank" href="https://twitter.com/BrendanEich/status/1271996047976312832">[Brendan Eich @Twitter]</a></span></sup></div></div><p>In JavaScript, calls being <strong>trapped</strong> by a Proxy’s <strong>handler</strong>, making it possible to virtually extend the target object with logic, provided that the behavior for those calls is implemented in the handler itself. Let’s take a look at an example and get into the details of traps afterwards.</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-353ae80598051b7050049c86c04adc06"></iframe></div><div style="text-align:center"><sup><b>Source 9</b> <span>Setting/getting properties of a target object trapped by a Proxy and its handler.</span></sup></div></div><p><strong>Step 1:</strong> We are defining a <code>target</code>- and a <code>handler</code>-object, both blank with no prototype inheritance (hence <code>Object.create(null)</code> — you can go ahead and use the object literal <code>{}</code> instead, it wouldn’t make a difference in our example). The handler has two methods — <code>get()</code> and <code>set()</code>.</p><p><strong>Step 2:</strong> After we have defined both objects, we’re creating a Proxy out of both — with <code>target</code> being the target object, and <strong>handler</strong> being the <strong>behavioral</strong> defined.</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/get" target="_blank" rel="noopener noreferrer">get()</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/set" target="_blank" rel="noopener noreferrer">set()</a> are <a href="https://en.wikipedia.org/wiki/Template_method_pattern" target="_blank" rel="noopener noreferrer"><strong>template methods</strong></a> and executed if they are available in the handler. The implementation is up to us (note: this goes for the complete set of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy#handler_functions" target="_blank" rel="noopener noreferrer">handler functions</a> available, of course).</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 6</b> <span>The syntax for get() <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/get">[MDN]</a></span></sup></div></div><div style="text-align:center;margin:20px"><div><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 7</b> <span>The syntax for set() <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/set">[MDN]</a></span></sup></div></div><p><strong>Step 3:</strong> We then assign a value to <code>proxy.say</code>— the setter-call is <strong>trapped</strong> by the <code>set()</code>-method defined in the Proxy, executing its implementation.</p><p><strong>Step 4:</strong> The same goes for <code>get</code>. When accessing a property of the trapped object, the implementation of the Proxy’s <code>get()</code> — method is called.</p><p>The arguments passed to both methods provide the appropriate meta-information about the context. In both, we find <code>target</code>, <code>property</code>, <code>receiver</code> — the naming should be obvious, except for <code>receiver</code>. To shed light into the dark: Here, <code>receiver</code> references the Proxy-instance.</p><blockquote><p>A Proxy in JavaScript does not magically trap method calls on a target object.</p></blockquote><p>Now, before we get too excited about it — there is one catch: Calling methods on a Proxy. Contrary to the believe, arbitrary method calls on a Proxy would automatically be trapped by some kind of magic methods (<a href="https://www.php.net/manual/en/language.oop5.magic.php" target="_blank" rel="noopener noreferrer">just like in PHP</a>), JavaScript handles it in a different way.</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-5001ab2dc0237460186c990cb07fe197"></iframe></div><div style="text-align:center"><sup><b>Source 10</b> <span>Magic methods in PHP. Calls to inaccessible methods on instances of the class “MethodTest” trigger __call()</span></sup></div></div><p>Actually, methods that should be trapped by a Proxy must be caught by the <code>get()</code>-implementation of the Proxy itself — and return a callable. Let’s see how the PHP example from above works with JavaScript:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-27c2630f29f37b5ce86c15b6dcf76604"></iframe></div><div style="text-align:center"><sup><b>Source 11</b> <span>An implementation of PHP’s __call() in JavaScript. The arguments are not available to the Proxy’s get()-method, since the trap snaps when the method is looked up, not when it’s called.</span></sup></div></div><p>However, the Proxy API allows for a way to also trap method calls, which seems to be a little bit cumbersome at first glance: Let’s have a look at the <code>apply()</code>-method:</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 7</b> <span>The apply()-method of the Proxy API allows for trapping method calls. <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/apply">[MDN]</a></span></sup></div></div><p>In order for <code>apply()</code>to work, we are now passing a <code>function</code> as the target, and call the proxy itself as if it was a function. That differs from the previously introduced use case of proxying an object and might be confusing, but we’ll get the hang of it shortly:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-e77f8ecbf36463cd5de9554263d2d2a4"></iframe></div><div style="text-align:center"><sup><b>Source 12</b> <span>Calling a Proxy on a trapped function triggers the handler’s apply()-method.</span></sup></div></div><p>In the given example, the target is an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener noreferrer">arrow function</a> that simply logs “I was not trapped” to the console. It’s behavior gets changed by the <code>trappedTarget</code>-Proxy and its handler, which — once called — produces the output “I was trapped”.</p><p>So, how, when and where does this make sense?</p><p>A trapped function call is aware of its context: The <code>target</code> itself, i.e. the original function being proxied, the <code>thisArg</code>, which is the object the call is <em>bound</em> to, and the <code>argumentsList</code>, containing all arguments passed to it.</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-a8876dfa04e4bcf5dae01276e57cf8cb"></iframe></div><div style="text-align:center"><sup><b>Source 13</b> <span>Forwarding information from the trapped function-call to the original function. We have changed from arrow functions to traditional function expressions to make use of call() and the arguments-object.</span></sup></div></div><p>Forwarding information from the trapped function-call to the original function. We have changed from arrow functions to traditional function expressions to make use of call() and the arguments-object.</p><p>Let’s make more sense of it:</p><ol><li>We can intercept method calls when that method is looked up on the Proxy — via <code>get()</code></li><li>We can use a Proxy for method calls, effectively changing the expected behavior by processing a different implementation — via <code>apply()</code></li></ol><p>Both concepts are chained together (pun intended, buckle up!) in the following example. Let this one sink. You should get the idea where we’re heading with this:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-e934051e2d77779cfeabb8f7c6dd5fa1"></iframe></div><div style="text-align:center"><sup><b>Source 14</b> <span></span></sup></div></div><p>Here’s what’s happening:
<strong>Step 1:</strong><code>trap(obj)</code></p><p>create Proxy for <code>obj</code></p><p><strong>Step 2.1:</strong><code>trap(target).foo</code></p><p><code>foo</code>is trapped and looked up in <code>get()</code>; <code>get()</code>returns <code>obj.foo()</code> as a proxied function, using the same handler as <code>obj</code></p><p><strong>Step 2.2:</strong><code>trap(target).foo()</code></p><p>The handler’s <code>apply()</code> method is called, serving as a Proxy for the foo<code>()</code>-method. The original <code>foo()</code>-method is available as the <code>target</code>-argument. This method is called, and the return value is logged on the console, producing <strong>“The Answer to the ultimate question of life, The Universe and Everything is…”</strong> as output. Contrary to the original implementation of <code>foo()</code>, its Proxy returns an object, <code>thisArg</code>, referencing the Proxy created for <code>obj</code>. If you’re struggling with this: <code>trap(obj).foo()</code>takes care of calling <code>foo</code> in the scope of the object <code>trap(obj)</code> represents — the Proxy.</p><p><strong>Step 3.1:</strong><code>trap(target).foo().bar</code></p><p><code>bar</code> is trapped by the return value of the proxied <code>foo()</code>-method (see 2.2. for the explanation) and looked up with <code>get()</code>; <code>get()</code> returns <code>obj.bar</code> as a proxied function, using the same handler as <code>obj</code>.</p><p><strong>Step 3.2:</strong> <code>trap(target).foo().bar()</code></p><p>the handler’s <code>apply()</code>-method is called, serving as a Proxy for the <code>bar()</code>-method. The original <code>bar()</code>-method is available as the <code>target</code>-argument. This method is called, and the return value is logged on the console, producing <strong>“42!”</strong> as output. Again, its Proxy returns an object, <code>thisArg</code>, referencing the same object our proxied <code>foo()</code> returned.</p><p>We have just created a Fluent Interface for an API that was not originally implemented as such. And I think that’s beautiful!</p><p>It’s finally time for the Fluent Interface implementation for Promises…</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-proxy-for-creating-fluent-interfaces-for-promises">A Proxy for creating Fluent Interfaces for Promises<a href="#a-proxy-for-creating-fluent-interfaces-for-promises" class="hash-link" aria-label="Direct link to A Proxy for creating Fluent Interfaces for Promises" title="Direct link to A Proxy for creating Fluent Interfaces for Promises">​</a></h2><p>The <code>liquify()</code>-Proxy is part of <a href="https://github.com/l8js/l8" target="_blank" rel="noopener noreferrer"><strong>l8js</strong></a>, a lightweight core JavaScript library that skips abstraction layers for the sake of a more lean approach towards functional programming.</p><p>The implementation follows the concept showcased in the previous example, where we effectively change the behavior of a Promise by advising the Proxy to trap API-calls in the <code>get()</code>- and <code>apply()</code> -methods of the handler.</p><p>Here’s its implementation:</p><div style="text-align:center;margin:20px"><div><iframe width="100%" frameborder="0" id="gist-f43426379399d4cc95945f8e7e9a57ff"></iframe></div><div style="text-align:center"><sup><b>Source 15</b> <span></span></sup></div></div><p><strong>Implementation Notes:</strong> This variant requires all of our <code>async</code> methods to return <code>this</code>, i.e. the owner of the asynchronous methods, so that the <code>onFulfilled</code>-callbacks forward this exact owner to the next link in the chain without too much of a hassle.</p><p>For example, the following will throw:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> source </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-variable function" style="color:rgb(80, 250, 123)">foo</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-variable function" style="color:rgb(80, 250, 123)">bar</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;somerandomstring&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                  </span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-variable function" style="color:rgb(80, 250, 123)">snafu</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;done&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">liquify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">foo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">bar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">snafu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// will throw an error since &quot;snafu()&quot; cannot be looked up anymore</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We will step through an example and inspect the various steps to get a better understanding of how this proxified Promise works:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> source </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-variable function" style="color:rgb(80, 250, 123)">foo</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-variable function" style="color:rgb(80, 250, 123)">bar</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function-variable function" style="color:rgb(80, 250, 123)">snafu</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;done&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">liquify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">foo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">bar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">snafu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 1:</strong> <code>liquify(source)</code>
This call will create a Proxy for <code>source,</code> with <code>handler</code> trapping further calls.</p><p><strong>Step 2:</strong> <code>liquify(source).foo</code>
… is trapped by the handler’s <code>get()</code>-method. Returns a <strong>bound(!)</strong> function (proxied again by <code>liquify()</code>), with <code>target</code> referencing <code>source,</code> and the <code>property</code> being <code>&quot;foo&quot;</code></p><p>return liquify(target<!-- -->[property]<!-- -->.bind(target))</p><p><strong>Step 3:</strong> <code>liquify(source).foo()</code>
The previous call to <code>liquify(source).foo</code> returned a proxied, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind" target="_blank" rel="noopener noreferrer"><strong>bound function</strong></a>. At this point, the method call <code>foo()</code> is now trapped in the Proxy’s <code>apply()</code>-method. The returned Promise is proxied again.</p><p>return liquify(target.apply(thisArg, argumentsList))</p><p><strong>Step 4:</strong> <code>liquify(source).foo().bar</code>
Step 3 returned a Promise, so <code>bar</code> as a property is now looked up on the Promise. The problem is, of course, that the Promise does not have a property called <code>bar</code>. We now have to take care of chaining the <code>source</code>-object through, so the following method call can properly resolve to <code>source.bar</code>.
We do this by implementing the <code>fulfilled</code>-callback. The <code>get</code>-handler will check if the target owns a <code>then</code>-method and return the following:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">liquify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">then</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">value</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">property</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">bind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           </span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">**</span><span class="token number">1</span><span class="token operator">**</span><span class="token operator">*</span><span class="token operator">^</span><span class="token operator">^</span><span class="token plain">     </span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">**</span><span class="token operator">*</span><span class="token operator">^</span><span class="token operator">^</span><span class="token plain">     </span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token plain"> </span><span class="token operator">**</span><span class="token number">3</span><span class="token operator">**</span><span class="token operator">*</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>1*</strong> the Promise that was proxied in step 3</li><li><strong>2*</strong> value is the return-value of the original source.foo()</li><li><strong>3*</strong> <code>property</code> is known to the implementation of the <code>fulfilled</code>-callback when it gets called (see: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures" target="_blank" rel="noopener noreferrer">lexical scope</a>). The return value of this callback is the method <code>bar</code>, bound to <code>source</code>, its owner.</li></ul><p><strong>Step 5:</strong> <code>liquify(source).foo().bar()</code>
The apply-handler now traps a callable. Since we have previously returned a Promise, and a Promise is not a callable method, we help ourselves with a clever trick: We are not directly wrapping the argument passed to <code>liquify</code> with the Proxy, but rather create function that is called. We “tag” this function with the property <code>__liquid__</code> that helps the handler to identify a proxied, callable method:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> promise </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">liquify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">promise</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">liquify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">target</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(80, 250, 123)">cb</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> target</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">__liquid__</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Proxy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What happens now is that this exact function is processed by the <code>apply()</code>-handler: <code>bar()</code> calls <code>cb()</code>; <code>cb()</code> returns a Promise, the <code>apply</code>-handler makes sure the <code>fulfilled</code>-callback is implemented, and returns the resulting Promise wrapped in a Proxy.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">liquify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">promise</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">then</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">value</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name">Reflect</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> thisArg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                   </span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">**</span><span class="token number">1</span><span class="token operator">**</span><span class="token operator">*</span><span class="token operator">^</span><span class="token operator">^</span><span class="token plain">   </span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">**</span><span class="token operator">*</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>1*</strong> the bound method that was returned in the <code>fulfilled</code>-callback implemented in Step 4</li><li><strong>2*</strong> The return value of the <code>fulfilled</code>-callback, which, in this case, is the call to <code>source.bar()</code>
It is important to use <code>args</code> here since it holds are the arguments referencing the <em>resolve</em>/<em>reject</em>-callbacks used by the last call in the chain</li></ul><p><strong>Step 6:</strong> <code>then()</code>
The last call in the chain is an implicit call to <code>then()</code> triggered by the Promise-instance that was proxied in Step 5. No more links (read: properties) have to be looked up — the chain ends at this point. <code>then</code> is a property on a
proxied Promise, so the handler traps it and simply binds the method to the Promise. The expression of the return statement of <code>async bar()</code> is returned, which equals to <code>&quot;done&quot;</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>Proxies provide a powerful tool to change the behavior of existing functionality, even when dealing with a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_define_property_object_not_extensible" target="_blank" rel="noopener noreferrer">locked API</a>.</p><div style="text-align:center;margin:20px"><div><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></div><div style="text-align:center"><sup><b>Figure 8</b> <span>A liquified Promise-chain helping to set up a and run a test suite with <a target="_blank" href="https://github.com/coon-js/siesta-lib-helper">@coon-js/siesta-lib-helper</a></span></sup></div></div><p>Of course, we’ve merely scratched the surface regarding Proxies. There are still, inter alia, methods like <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/set" target="_blank" rel="noopener noreferrer">set()</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/preventExtensions" target="_blank" rel="noopener noreferrer">preventExtension()</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/revocable" target="_blank" rel="noopener noreferrer"><strong>Proxy.revocable()</strong></a>, which allows for switching off a Proxy during runtime. If you’d like to know more, head over to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener noreferrer">MDN</a>, then take your time to read through <a href="https://blog.bitsrc.io/a-practical-guide-to-es6-proxy-229079c3c2f0" target="_blank" rel="noopener noreferrer">A practical guide to JavaScript Proxy</a>, which gives a good overview of the advanced concepts of Proxies. And of course, I’m not the first one who dealt with Fluent Interfaces and Promises. For example, have a look at the implementation of <a href="https://github.com/kozhevnikov" target="_blank" rel="noopener noreferrer">Ilya Kozhevniko</a>‘s <em>proxymise</em> <a href="https://github.com/kozhevnikov/proxymise" target="_blank" rel="noopener noreferrer">here</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/thorstensuckow/thorsten.suckow-homberg.de/tree/main/docs/articles/a-fluent-interface-for-javascript-promises/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-04T20:45:57.000Z">Apr 4, 2023</time></b> by <b>Thorsten Suckow-Homberg</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/articles/javascript-promises-return-values-and-error-handlers/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">JavaScript Promises — Return Values and Error Handlers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#know-your-tools" class="table-of-contents__link toc-highlight">Know your tools</a></li><li><a href="#fluent-interfaces" class="table-of-contents__link toc-highlight">Fluent Interfaces</a></li><li><a href="#en-attendant-godot" class="table-of-contents__link toc-highlight">En attendant <strong>Godot</strong></a></li><li><a href="#deus-ex-machina" class="table-of-contents__link toc-highlight">Deus ex Machina</a></li><li><a href="#the-proxy-in-javascript" class="table-of-contents__link toc-highlight">The Proxy in JavaScript</a></li><li><a href="#a-proxy-for-creating-fluent-interfaces-for-promises" class="table-of-contents__link toc-highlight">A Proxy for creating Fluent Interfaces for Promises</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">copyright © 2023 <a href="/imprint">Thorsten Suckow-Homberg</a>. Except where otherwise noted, the content on this page is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.c73620db.js"></script>
<script src="/assets/js/main.de22530c.js"></script>
</body>
</html>