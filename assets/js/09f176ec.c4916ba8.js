(self.webpackChunkthorsten_suckow_homberg_de=self.webpackChunkthorsten_suckow_homberg_de||[]).push([[406],{477:()=>{},2172:(s,e,a)=>{"use strict";a.d(e,{$z:()=>o,C9:()=>m,IX:()=>j,ZX:()=>p,eJ:()=>d,uR:()=>x});var n=a(6540),i=a(4882),t=a(8069),r=a(4945),l=a.n(r),c=a(2897),h=(a(3271),a(4848));function m(s){let{width:e,children:a,title:n,figure:t,figref:r,modeAware:l}=s;return(0,h.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,h.jsxs)("div",{style:{maxWidth:e,textAlign:"center",margin:20},children:[r&&(0,h.jsx)("a",{name:`fig_${r}`}),(0,h.jsx)("div",{className:!1!==l?"umlImg":"",children:a}),(0,h.jsx)("div",{style:{textAlign:"center"},children:(0,h.jsxs)("sup",{children:[(0,h.jsx)("b",{children:i.A.isString(t)?t:`Figure ${t??r??1}`})," ",(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})]})})]})})}function d(s){let{id:e,source:a,title:n}=s;return(0,h.jsx)(m,{modeAware:!1,title:n,figure:`Source ${a}`,children:(0,h.jsx)(c.A,{id:e})})}function o(s){let{url:e,figure:a,title:n}=s;return(0,h.jsx)(m,{modeAware:!1,figure:a,title:n,children:(0,h.jsx)("img",{alt:"{title}",src:e})})}function x(s){let{children:e,figure:a,title:n}=s;return(0,h.jsx)(m,{modeAware:!0,figure:a,title:n,children:e})}function p(s){let{when:e,where:a}=s;const[n,i]=a;return(0,h.jsxs)("div",{children:["This article was originally published in ",e," at ",(0,h.jsx)("a",{target:"_blank",href:i,children:n}),". Some formatting might have get lost during the migration to this site: If you think you spotted an issue caused by malformed formatting, feel free to open a ",(0,h.jsx)("a",{href:"https://github.com/ThorstenSuckow/thorsten.suckow-homberg.de",children:"Pull Request"})," or ",(0,h.jsx)("a",{href:"mailto:thorsten@suckow-homberg.de",children:"send me an Email"}),"."]})}function j(s){let{url:e}=s;const[a,i]=n.useState("");return l()(e).then((s=>{s.text().then((s=>i(s)))})),(0,h.jsx)(t.A,{language:"php",children:a})}},3271:(s,e,a)=>{"use strict";a.d(e,{R5:()=>i,I8:()=>i,Dn:()=>t,lA:()=>r,E4:()=>i,$1:()=>r});a(6540);var n=a(4848);function i(s){let{name:e,pp:a,add:i}=s;const t=`#bibref-${e.toLowerCase()}`;return(0,n.jsxs)("a",{href:t,children:["[",(0,n.jsxs)("span",{className:"bibRef",children:["\ud83d\udcd6",e]}),i?`, ${i} `:"",a?`, ${a.includes("-")?"pp":"p"}. ${a}`:"","]"]})}function t(s){let{idx:e}=s;return(0,n.jsx)("a",{href:`#fig_${e}`,children:(0,n.jsxs)("span",{className:"bibRef",children:["Figure ",e]})})}function r(s){let{name:e,file:a,url:i}=s;a=a||(i||""),Object.entries({sd:"softwaredesign",sa:"softwarearchitecture",cs:"computerscience"}).some((s=>{let[e,n]=s;if(a.startsWith(`${e}.`))return a=a.replace(`${e}.`,`${n}.`),!0}));const t=`/docs/wiki/${a}`;return(0,n.jsx)("a",{href:t,className:"glosRef",children:e})}},5142:(s,e,a)=>{"use strict";a.d(e,{o:()=>i});a(6540);var n=a(4848);function i(){return(0,n.jsx)("div",{style:{width:"100%",textAlign:"right"},children:(0,n.jsx)("a",{style:{textDecoration:"underline"},onClick:()=>history.go(-1),href:"#",children:"Back"})})}},8453:(s,e,a)=>{"use strict";a.d(e,{R:()=>r,x:()=>l});var n=a(6540);const i={},t=n.createContext(i);function r(s){const e=n.useContext(t);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function l(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:r(s.components),n.createElement(t.Provider,{value:e},s.children)}},9920:(s,e,a)=>{"use strict";a.r(e),a.d(e,{assets:()=>o,bibRefs:()=>x,contentTitle:()=>d,default:()=>u,figures:()=>p,frontMatter:()=>m,metadata:()=>n,toc:()=>j});const n=JSON.parse('{"id":"wiki/csec.ssltls","title":"SSL/TLS","description":"SSL (Secure Socket Layer, ) is a communication protocol providing confidentiality, authenticity and integrity in network communications.","source":"@site/docs/wiki/csec.ssltls.mdx","sourceDirName":"wiki","slug":"/wiki/csec.ssltls","permalink":"/docs/wiki/csec.ssltls","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/thorsten.suckow-homberg.de/tree/main/docs/wiki/csec.ssltls.mdx","tags":[{"inline":true,"label":"information security","permalink":"/docs/tags/information-security"},{"inline":true,"label":"computer networks","permalink":"/docs/tags/computer-networks"}],"version":"current","lastUpdatedBy":"ThorstenSuckow","lastUpdatedAt":1756754619000,"frontMatter":{"title":"SSL/TLS","tags":["information security","computer networks"]},"sidebar":"wiki","previous":{"title":"Spanning Tree","permalink":"/docs/wiki/graphtheory.spanningtree"},"next":{"title":"Symptoms of Poor Design","permalink":"/docs/wiki/softwaredesign.symptomsofpoordesign"}}');var i=a(4848),t=a(8453),r=a(3271),l=a(2172);a(5142);const c=a.p+"assets/images/tlssocket-525fa7b733f4e714824f58aac9e1917a.png",h=a.p+"assets/images/tlssequence-7d4aef257c80500e074be247cc1dfba2.png",m={title:"SSL/TLS",tags:["information security","computer networks"]},d="SSL/TLS (Network Security)",o={},x=["RFC6101","RFC7568","RFC8446","TFW21","Eck23","RFC5246","SF12"],p={sslsocket:1,tlssequence:2},j=[{value:"SSL/TLS Handshake",id:"ssltls-handshake",level:3},{value:"Record Protocol",id:"record-protocol",level:3},{value:"Forward Secrecy",id:"forward-secrecy",level:3},{value:"TLS 1.3",id:"tls-13",level:4}];function g(s){const e={a:"a",annotation:"annotation",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",msub:"msub",mtext:"mtext",ol:"ol",p:"p",section:"section",semantics:"semantics",span:"span",strong:"strong",sup:"sup",...(0,t.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"ssltls-network-security",children:"SSL/TLS (Network Security)"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SSL"})," (",(0,i.jsx)(e.em,{children:"Secure Socket Layer"}),", ",(0,i.jsx)(r.E4,{name:"RFC6101"}),") is a communication protocol providing confidentiality, authenticity and integrity in network communications."]}),"\n",(0,i.jsxs)(e.p,{children:["SSL 3.0 was deprecated by ",(0,i.jsx)(r.E4,{name:"RFC7568"})," and superseded by ",(0,i.jsx)(e.strong,{children:"TLS"})," (",(0,i.jsx)(e.em,{children:"Transport Layer Security"}),", ",(0,i.jsx)(r.E4,{name:"RFC8446"}),", which is based on SSL 3.0 but introduces breaking changes, such as the mechanism for deriving the ",(0,i.jsx)(e.strong,{children:"premaster secret"})," and the use of ",(0,i.jsx)(e.em,{children:"nonces"}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["To ensure backward compatibility, many clients (such as web browsers) often support both protocols. Thus, the umbrella term ",(0,i.jsx)(e.strong,{children:"SSL/TLS"})," is used whenever it's unclear in advance which protocol will be negotiated (",(0,i.jsx)(r.E4,{name:"TFW21",pp:"841"}),")."]}),"\n",(0,i.jsxs)(e.p,{children:["While classified as application layer protocols, they are often described as intermediate layers between the application and transport layer, since they encapsulate cryptographic services, exposed by standardized interfaces for data-input and -output (see ",(0,i.jsx)(r.Dn,{idx:p.sslsocket}),")."]}),"\n",(0,i.jsx)(l.C9,{modeAware:!0,figref:p.sslsocket,width:400,title:"SSL / TLS as a sublayer between transport and application layer in the 5-layer internet model. (Source: adapted from [KR20, Figure 8.24, 645])",children:(0,i.jsx)("img",{src:c})}),"\n",(0,i.jsx)(e.h3,{id:"ssltls-handshake",children:"SSL/TLS Handshake"}),"\n",(0,i.jsxs)(e.p,{children:["To establish secure communications, Client and Server initiate the protocol using a ",(0,i.jsx)(e.em,{children:"handshake"})," , where certificates, keys and other various parameters for the session are defined."]}),"\n",(0,i.jsxs)(e.p,{children:["The TLS-handshake can be divided roughly into the following steps, whereas the SSL 3.0 handshake follows a similar structure (",(0,i.jsx)(r.E4,{name:"TFW21",pp:"839 f."}),", ",(0,i.jsx)(r.E4,{name:"Eck23",pp:"796 ff."}),"). For TLS 1.3, several changes have been made to the protocol, notably"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:['"Static RSA and Diffie-Hellman cipher suites have been removed; all\npublic-key based key exchange mechanisms now provide forward\nsecrecy." ',(0,i.jsx)(r.E4,{name:"RFC8446",add:"Section 1.2"})]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Therefore, the description of the handshake protocol - which is illustrated in ",(0,i.jsx)(r.Dn,{idx:p.tlssequence})," -  follows TLS 1.2 (",(0,i.jsx)(r.E4,{name:"RFC5246"}),")"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ClientHello"}),": Communication begins with the client by sending a list of ",(0,i.jsx)(e.em,{children:"cipher suites"})," (",(0,i.jsx)(r.E4,{name:"RFC5246",add:"A.5. The Cipher Suite"}),"), containing preferences regarding the encryption- and compression-algorithms to use for the following session",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-helo",id:"user-content-fnref-helo","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),". The client also sends  a ",(0,i.jsx)(e.em,{children:"nonce"})," ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"C"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"R_C"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"C"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),", used for deriving the ",(0,i.jsx)(e.strong,{children:"master secret"})," later on."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ServerHello"}),": The server selects from this list based on its own implementation. The data is sent back to the client including the server-nonce ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"S"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"R_S"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Following up on the previous message, the server then sends its certificate data in form of a ",(0,i.jsx)(r.lA,{name:"x.509-certificate",file:"csec.x509"})," (unless otherwise negotiated) containing its public key. Various other messages from the server may follow, such as certificate chains if the server's certificate is not ",(0,i.jsx)(e.em,{children:"directly"})," signed by a well-known CA. The root CA must be in the trust store of the client for the secure connection to be established:"]}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:["[...] the self-signed certificate that specifies the root\ncertificate authority MAY be omitted from the chain, under the\nassumption that the remote end must already possess it in order to\nvalidate it in any case.`` ",(0,i.jsx)(r.E4,{name:"RFC5246",add:"Section 7.4.2"})," ",(0,i.jsx)("br",{})," Additionally, the server requests the client's certificate (",(0,i.jsx)(r.E4,{name:"TFW21",p:"839"}),"). The server sends a ",(0,i.jsx)(e.code,{children:"ServerHelloDone"})," once finished with this."]}),"\n"]}),"\n",(0,i.jsxs)(e.ol,{start:"4",children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ClientKeyExchange"}),": The client validates the server certificate and begins the key exchange procedure, which includes generating a seed, the ",(0,i.jsx)(e.strong,{children:"premaster secret"})," ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),": If ",(0,i.jsx)(e.code,{children:"RSA"})," is used for key exchange, ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," is generated by the client, encrypted with the ",(0,i.jsx)(e.strong,{children:"public key of the server"}),", then sent to the server (",(0,i.jsx)(r.E4,{name:"Eck23",pp:"798"}),"). If Diffie-Hellman is used, ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," is generated by both parties independently, resulting in the same value for ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),". The ",(0,i.jsx)(e.strong,{children:"premaster secret"})," is used in the next step for deriving the ",(0,i.jsx)(e.strong,{children:"master secret"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ChangeCipherSpec"}),"/",(0,i.jsx)(e.code,{children:"Finished"}),": Both client and server now compute the ",(0,i.jsx)(e.strong,{children:"master secret"})," from ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),", ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"C"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"R_C"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"C"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," and ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"S"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"R_S"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),", using a pseudorandom function (PRF) (",(0,i.jsx)(r.E4,{name:"RFC5246",add:"Section 8.1"}),"):"]}),"\n"]}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"r"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"F"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:'"'}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mtext,{children:"\xa0"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:'"'}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"C"})]}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mi,{children:"S"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:'K_{Master} = PRF(K_{Pre}, "master\\ secret", R_C + R_S)'})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"},children:"M"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"s"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"er"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"PRF"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:'"'}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"ma"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,i.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"secre"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord",children:'"'}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"C"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["Once the client has computed the master secret, it signals the start of encrypted communication via a ",(0,i.jsx)(e.code,{children:"ChangeCipherSpec"})," message, followed by a ",(0,i.jsx)(e.code,{children:"Finished"})," message to authenticate the handshake: This message contains a hash over all preceding handshake messages and is the first ",(0,i.jsx)(e.em,{children:"protected"})," message with the negotiated algorithms, keys and secrets applied - it is therefore crucial that the receiving peer validates this message (",(0,i.jsx)(e.a,{href:"https://datatracker.ietf.org/doc/html/rfc5246#section-7.4.9",children:"RFC5246, Section 7.4.9"}),"). The server repeats the procedure. After this, payload can be sent using the ",(0,i.jsx)(e.strong,{children:"Record Protocol"}),", where messages are authenticated and encrypted using the keys derived from the ",(0,i.jsx)(e.strong,{children:"master secret"}),"."]}),"\n",(0,i.jsx)(l.C9,{modeAware:!0,width:800,figref:p.tlssequence,title:"Sequence diagram of a TLS 1.2 Handshake. (Source: adapted from [SF12, Figure 18-30, 881])",children:(0,i.jsx)("img",{src:h})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(r.Dn,{idx:p.tlssequence})," also illustrates how TLS 1.2 supports session resumption - based on session ids shared by both client and the server, most of the key exchange and verification steps can be skipped if the communicating parties have previously established trust."]}),"\n",(0,i.jsxs)(e.p,{children:["Also, if the server requests client certification, an additional ",(0,i.jsx)(e.code,{children:"CertificateVerify"}),"-message containing a signature over all preceding handshake messages is sent by the client, to prove it's in possession of the private key corresponding to a previously sent certificate, if one was provided (",(0,i.jsx)(r.E4,{name:"SF12",pp:"880 f."}),")."]}),"\n",(0,i.jsx)(e.h3,{id:"record-protocol",children:"Record Protocol"}),"\n",(0,i.jsxs)(e.p,{children:["Data between the communicating parties is exchanged via the ",(0,i.jsx)(e.strong,{children:"Record Protocol"}),". Its responsibilities are fragmentation of the application data into chunks not larger than 16KB.\nThe fragments are optionally compressed",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-compression",id:"user-content-fnref-compression","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),", a MAC is calculated using a key derived from the ",(0,i.jsx)(e.strong,{children:"master secret"}),". Finally, the result is encrypted using a symmetric cryptographic algorithm."]}),"\n",(0,i.jsx)(e.h3,{id:"forward-secrecy",children:"Forward Secrecy"}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.code,{children:"ServerKeyExchange"}),"-message in TLS 1.2 is used to include Diffie-Hellman parameters for a Diffie-Hellman key exchange with the client:\nThe server sends this message if both client and server negotiated a non RSA-based cipher suite for the session, in which case the client would encrypt ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),"  with the public key of the server.\nUsing  the ",(0,i.jsx)(e.code,{children:"ServerKeyExchange"}),"-message with ephemeral Diffie-Hellman parameters establishes ",(0,i.jsx)(e.strong,{children:"Forward Secrecy"})," in TLS 1.2, as the message would contain the parameters signed with a private key, e.g. using DSS (",(0,i.jsx)(e.em,{children:"Digital Signature Standard"}),")",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-dss",id:"user-content-fnref-dss","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})})," or RSA, which the client verifies.",(0,i.jsx)("br",{}),"\nThe client sends its DH-public-key in the ",(0,i.jsx)(e.code,{children:"ClientKeyExchange"})," message in return.",(0,i.jsx)("br",{}),"\nA compromised private key of the server would mean that previous session data cannot be decrypted, as the private key was only used for signing, not for encryption."]}),"\n",(0,i.jsx)(e.h4,{id:"tls-13",children:"TLS 1.3"}),"\n",(0,i.jsxs)(e.p,{children:["As a major difference between TLS 1.2 and TLS 1.3, ",(0,i.jsx)(r.E4,{name:"RFC8446"})," specifies that"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:['"- Static RSA and Diffie-Hellman cipher suites have been removed; all\npublic-key based key exchange mechanisms now provide forward\nsecrecy. ',(0,i.jsx)("br",{}),' - All handshake messages after the ServerHello are now encrypted.\nThe newly introduced EncryptedExtensions message allows various\nextensions previously sent in the clear in the ServerHello to also\nenjoy confidentiality protection."']}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["This establishes ",(0,i.jsx)(e.strong,{children:"ForwardSecrecy"})," by default, as the server and the client negotiate ephemeral Diffie-Hellman key shares in the ",(0,i.jsx)(e.code,{children:"ClientHello"}),"/",(0,i.jsx)(e.code,{children:"ServerHello"}),"-messages using the ",(0,i.jsx)(e.code,{children:"key_share"}),"-extension (or the ",(0,i.jsx)(e.code,{children:"pre_shared_key"}),"-extension, if applicable). For TLS 1.3, dedicated key exchange messages such as ",(0,i.jsx)(e.code,{children:"ClientKeyExchange"})," and ",(0,i.jsx)(e.code,{children:"ServerKeyExchange"})," are removed."]}),"\n",(0,i.jsx)(e.hr,{}),"\n","\n",(0,i.jsxs)(e.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(e.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{id:"user-content-fn-helo",children:["\n",(0,i.jsxs)(e.p,{children:["so called ",(0,i.jsx)(e.strong,{children:"Authenticated Encryption with Associated Data"})," (",(0,i.jsx)(e.em,{children:"AEAD"}),") for establishing confidentiality, and ",(0,i.jsx)(e.strong,{children:"HMAC-based Extract-and-Expand Key Derivation Function"})," (",(0,i.jsx)(e.em,{children:"HKDF"}),") for establishing integrity (since TLS 1.3) ",(0,i.jsx)(e.a,{href:"#user-content-fnref-helo","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{id:"user-content-fn-compression",children:["\n",(0,i.jsxs)(e.p,{children:["Compression can expose security risks; see ",(0,i.jsx)(e.a,{href:"https://nvd.nist.gov/vuln/detail/CVE-2012-4929",children:"CVE-2012-4929"})," (retrieved 11.05.2025) ",(0,i.jsx)(e.a,{href:"#user-content-fnref-compression","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{id:"user-content-fn-dss",children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://csrc.nist.gov/pubs/fips/186-5/final",children:"https://csrc.nist.gov/pubs/fips/186-5/final"})," (retrieved 16.05.2025) ",(0,i.jsx)(e.a,{href:"#user-content-fnref-dss","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function u(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(g,{...s})}):g(s)}}}]);