(self.webpackChunkthorsten_suckow_homberg_de=self.webpackChunkthorsten_suckow_homberg_de||[]).push([[4226],{477:()=>{},2172:(e,s,n)=>{"use strict";n.d(s,{$z:()=>d,C9:()=>o,IX:()=>j,ZX:()=>p,eJ:()=>m,uR:()=>x});var t=n(6540),a=n(4882),i=n(8069),r=n(4945),l=n.n(r),c=n(2897),h=(n(4843),n(4848));function o(e){let{width:s,children:n,title:t,figure:i,figref:r,modeAware:l}=e;return(0,h.jsxs)("div",{style:{width:s,textAlign:"center",margin:20},children:[r&&(0,h.jsx)("a",{name:`fig_${r}`}),(0,h.jsx)("div",{className:!1!==l?"umlImg":"",children:n}),(0,h.jsx)("div",{style:{textAlign:"center"},children:(0,h.jsxs)("sup",{children:[(0,h.jsx)("b",{children:a.A.isString(i)?i:`Figure ${i??r??1}`})," ",(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]})})]})}function m(e){let{id:s,source:n,title:t}=e;return(0,h.jsx)(o,{modeAware:!1,title:t,figure:`Source ${n}`,children:(0,h.jsx)(c.A,{id:s})})}function d(e){let{url:s,figure:n,title:t}=e;return(0,h.jsx)(o,{modeAware:!1,figure:n,title:t,children:(0,h.jsx)("img",{alt:"{title}",src:s})})}function x(e){let{children:s,figure:n,title:t}=e;return(0,h.jsx)(o,{modeAware:!0,figure:n,title:t,children:s})}function p(e){let{when:s,where:n}=e;const[t,a]=n;return(0,h.jsxs)("div",{children:["This article was originally published in ",s," at ",(0,h.jsx)("a",{target:"_blank",href:a,children:t}),". Some formatting might have get lost during the migration to this site: If you think you spotted an issue caused by malformed formatting, feel free to open a ",(0,h.jsx)("a",{href:"https://github.com/ThorstenSuckow/thorsten.suckow-homberg.de",children:"Pull Request"})," or ",(0,h.jsx)("a",{href:"mailto:thorsten@suckow-homberg.de",children:"send me an Email"}),"."]})}function j(e){let{url:s}=e;const[n,a]=t.useState("");return l()(s).then((e=>{e.text().then((e=>a(e)))})),(0,h.jsx)(i.A,{language:"php",children:n})}},2772:(e,s,n)=>{"use strict";n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>m,default:()=>g,figures:()=>x,frontMatter:()=>o,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"toolbox/computernetworks.ssltls","title":"SSL/TLS","description":"SSL (Secure Socket Layer) is a communication protocol providing confidentiality, authenticity and integrity in network communications.","source":"@site/docs/toolbox/computernetworks.ssltls.mdx","sourceDirName":"toolbox","slug":"/toolbox/computernetworks.ssltls","permalink":"/docs/toolbox/computernetworks.ssltls","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/thorsten.suckow-homberg.de/tree/main/docs/toolbox/computernetworks.ssltls.mdx","tags":[],"version":"current","lastUpdatedBy":"Thorsten Suckow-Homberg","lastUpdatedAt":1747087327000,"frontMatter":{"title":"SSL/TLS"},"sidebar":"toolbox","previous":{"title":"Spanning Tree","permalink":"/docs/toolbox/graphtheory.spanningtree"},"next":{"title":"Symptoms of Poor Design","permalink":"/docs/toolbox/softwaredesign.symptomsofpoordesign"}}');var a=n(4848),i=n(8453),r=n(4843),l=n(2172);n(5142);const c=n.p+"assets/images/tlssocket-525fa7b733f4e714824f58aac9e1917a.png",h=n.p+"assets/images/tlssequence-7d4aef257c80500e074be247cc1dfba2.png",o={title:"SSL/TLS"},m="SSL/TLS",d={},x={sslsocket:1,tlssequence:2},p=[{value:"SSL/TLS Handshake",id:"ssltls-handshake",level:3},{value:"Record Protocol",id:"record-protocol",level:3}];function j(e){const s={a:"a",annotation:"annotation",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",math:"math",mi:"mi",mrow:"mrow",msub:"msub",ol:"ol",p:"p",section:"section",semantics:"semantics",span:"span",strong:"strong",sup:"sup",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"ssltls",children:"SSL/TLS"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"SSL"}),(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-ssl",id:"user-content-fnref-ssl","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})," (",(0,a.jsx)(s.em,{children:"Secure Socket Layer"}),") is a communication protocol providing confidentiality, authenticity and integrity in network communications."]}),"\n",(0,a.jsxs)(s.p,{children:["SSL 3.0 was deprecated by ",(0,a.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc7568",children:"RFC7568"})," and superseded by ",(0,a.jsx)(s.strong,{children:"TLS"}),(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-tls",id:"user-content-fnref-tls","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})," (",(0,a.jsx)(s.em,{children:"Transport Layer Security"}),"), which is based on SSL 3.0 but introduces breaking changes, such as the mechanism for deriving the ",(0,a.jsx)(s.strong,{children:"premaster secret"})," and the use of ",(0,a.jsx)(s.em,{children:"nonces"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["To ensure backward compatibility, many clients (such as web browsers) often support both protocols. Thus, the umbrella term ",(0,a.jsx)(s.strong,{children:"SSL/TLS"})," is used whenever it's unclear in advance which protocol will be negotiated (",(0,a.jsx)(r.R5,{name:"TFW21",pp:"841"}),")."]}),"\n",(0,a.jsxs)(s.p,{children:["While classified as application layer protocols, they are often described as intermediate layers between the application and transport layer, since they encapsulate cryptographic services, exposed by standardized interfaces for data-input and -output (see ",(0,a.jsx)(r.Dn,{idx:x.sslsocket}),")."]}),"\n",(0,a.jsx)(l.C9,{modeAware:!0,figref:x.sslsocket,title:"SSL / TLS as a sublayer between transport and application layer in the 5-layer internet model. (Source: adapted from [KR20, Figure 8.24, 645])",children:(0,a.jsx)("img",{src:c})}),"\n",(0,a.jsx)(s.h3,{id:"ssltls-handshake",children:"SSL/TLS Handshake"}),"\n",(0,a.jsxs)(s.p,{children:["To establish secure communications, Client and Server initiate the protocol using a ",(0,a.jsx)(s.em,{children:"handshake"})," , where certificates, keys and other various parameters for the session are defined."]}),"\n",(0,a.jsxs)(s.p,{children:["The TLS-handshake can be divided roughly into the following steps, whereas the SSL 3.0 handshake follows a similar structure (",(0,a.jsx)(r.R5,{name:"TFW21",pp:"839 f."}),", ",(0,a.jsx)(r.R5,{name:"Eck23",pp:"796 ff."}),"). For TLS 1.3, several changes have been made to the protocol, notably"]}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:['"Static RSA and Diffie-Hellman cipher suites have been removed; all\npublic-key based key exchange mechanisms now provide forward\nsecrecy." ',(0,a.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc8446#section-1.2",children:"RFC8446, section 1.2"})]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Therefore, the description of the handshake protocol - which is illustrated in ",(0,a.jsx)(r.Dn,{idx:x.tlssequence})," -  follows TLS 1.2 (",(0,a.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc5246",children:"RFC5246"}),")"]}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"ClientHello"}),": Communication begins with the client by sending a list of ",(0,a.jsx)(s.em,{children:"cipher suites"})," (",(0,a.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc5246#appendix-A.5",children:"RFC5246, A.5. The Cipher Suite"}),"), containing preferences regarding the encryption- and compression-algorithms to use for the following session",(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-helo",id:"user-content-fnref-helo","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})}),". The client also sends  a ",(0,a.jsx)(s.em,{children:"nonce"})," ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"R"}),(0,a.jsx)(s.mi,{children:"C"})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"R_C"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"C"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]}),", used for deriving the ",(0,a.jsx)(s.strong,{children:"master secret"})," later on."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"ServerHello"}),": The server selects from this list based on its own implementation. The data is sent back to the client including the server-nonce ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"R"}),(0,a.jsx)(s.mi,{children:"S"})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"R_S"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Following up on the previous message, the server then sends its certificate data (e.g. a ",(0,a.jsx)(r.lA,{name:"x.509-certificate",file:"csec.x509"}),") containing its public key. Various other messages from the server may follow, such as certificate chains if the server's certificate is not signed by a well-known CA, and possibly requesting the client's certificate (",(0,a.jsx)(r.R5,{name:"TFW21",p:"839"}),"). The server sends a ",(0,a.jsx)(s.code,{children:"ServerHelloDone"})," once finished with this."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"ClientKeyExchange"}),": The client validates the server certificate and begins the key exchange procedure, which includes generating a seed, the ",(0,a.jsx)(s.strong,{children:"premaster secret"})," ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"K"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"P"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"e"})]})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]}),": If ",(0,a.jsx)(s.code,{children:"RSA"})," is used for key exchange, ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"K"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"P"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"e"})]})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]})," is generated by the client, encrypted with the ",(0,a.jsx)(s.strong,{children:"public key of the server"}),", then sent to the server (",(0,a.jsx)(r.R5,{name:"Eck23",pp:"798"}),"). If Diffie-Hellmann is used, ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"K"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"P"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"e"})]})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]})," is generated by both parties independently, resulting in the same value for ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"K"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"P"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"e"})]})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]}),". The ",(0,a.jsx)(s.strong,{children:"premaster secret"})," is used in the next step for deriving the ",(0,a.jsx)(s.strong,{children:"master secret"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"ChangeCipherSpec"}),"/",(0,a.jsx)(s.code,{children:"Finished"}),": Both client and server now compute the ",(0,a.jsx)(s.strong,{children:"master secret"})," from ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"K"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"P"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"e"})]})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"K_{Pre}"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"re"})]})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]}),", ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"R"}),(0,a.jsx)(s.mi,{children:"C"})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"R_C"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.07153em"},children:"C"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]})," and ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"R"}),(0,a.jsx)(s.mi,{children:"S"})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"R_S"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]}),", using a pseudorandom function (PRF).\nOnce the client finished computing the master secret, it lets the server know via a ",(0,a.jsx)(s.code,{children:"ChangeCipherSpec"})," message, followed by a ",(0,a.jsx)(s.code,{children:"Finished"})," message to authenticate the handshake. The server repeats the procedure. After this, payload can be sent using the ",(0,a.jsx)(s.strong,{children:"Record Protocol"}),", where subsequent keys for encrypting data and for generating MACs used with the ",(0,a.jsx)(s.strong,{children:"Record Protocol"})," are derived from the ",(0,a.jsx)(s.strong,{children:"master secret"}),"."]}),"\n"]}),"\n",(0,a.jsx)(l.C9,{modeAware:!0,figref:x.tlssequence,title:"Sequence diagram of a TLS 1.2 Handshake. (Source: adapted from [FS12, Figure 18-30, 881])",children:(0,a.jsx)("img",{src:h})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(r.Dn,{idx:x.tlssequence})," also illustrates how TLS 1.2 supports session resumption - based on session ids shared by both client and the server, most of the key exchange and verification steps can be skipped if the communicating parties have previously established trust."]}),"\n",(0,a.jsxs)(s.p,{children:["Also, if the server requests client certification, an additional ",(0,a.jsx)(s.code,{children:"CertificateVerify"}),"-message containing a signature over all preceding handshake messages is sent by the client, to prove it's in possession of the private key corresponding to a previously sent certificate, if one was provided (",(0,a.jsx)(r.R5,{name:"FS12",pp:"880 f."}),")."]}),"\n",(0,a.jsx)(s.h3,{id:"record-protocol",children:"Record Protocol"}),"\n",(0,a.jsxs)(s.p,{children:["Data between the communicating parties is exchanged via the ",(0,a.jsx)(s.strong,{children:"Record Protocol"}),". Its responsibilities are fragmentation of the application data into chunks not larger than 16KB.\nThe fragments are optionally compressed",(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-compression",id:"user-content-fnref-compression","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"4"})}),", a MAC is calculated using a key derived from the ",(0,a.jsx)(s.strong,{children:"master secret"}),". Finally, the result is encrypted using a symmetric cryptographic algorithm."]}),"\n",(0,a.jsx)(s.hr,{}),"\n","\n",(0,a.jsxs)(s.section,{"data-footnotes":!0,className:"footnotes",children:[(0,a.jsx)(s.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{id:"user-content-fn-ssl",children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc6101",children:"RFC6101"})," ",(0,a.jsx)(s.a,{href:"#user-content-fnref-ssl","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{id:"user-content-fn-tls",children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc8446",children:"RFC8446"})," ",(0,a.jsx)(s.a,{href:"#user-content-fnref-tls","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{id:"user-content-fn-helo",children:["\n",(0,a.jsxs)(s.p,{children:["so called ",(0,a.jsx)(s.strong,{children:"Authenticated Encryption with Associated Data"})," (",(0,a.jsx)(s.em,{children:"AEAD"}),") for establishing confidentiality, and ",(0,a.jsx)(s.strong,{children:"HMAC-based Extract-and-Expand Key Derivation Function"})," (",(0,a.jsx)(s.em,{children:"HKDF"}),") for establishing integrity (since TLS 1.3) ",(0,a.jsx)(s.a,{href:"#user-content-fnref-helo","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{id:"user-content-fn-compression",children:["\n",(0,a.jsxs)(s.p,{children:["Compression can expose security risks; see ",(0,a.jsx)(s.a,{href:"https://nvd.nist.gov/vuln/detail/CVE-2012-4929",children:"CVE-2012-4929"})," (retrieved 11.05.2025) ",(0,a.jsx)(s.a,{href:"#user-content-fnref-compression","data-footnote-backref":"","aria-label":"Back to reference 4",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function g(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(j,{...e})}):j(e)}},4843:(e,s,n)=>{"use strict";n.d(s,{Dn:()=>i,R5:()=>a,lA:()=>r});n(6540);var t=n(4848);function a(e){let{name:s,pp:n}=e;const a=`/docs/bibliography#${s.toLowerCase()}`;return(0,t.jsxs)("a",{href:a,children:["[",(0,t.jsxs)("span",{className:"bibRef",children:["\ud83d\udcd6",s]}),n?`, ${n.includes("-")?"pp":"p"}. ${n}`:"","]"]})}function i(e){let{idx:s}=e;return(0,t.jsx)("a",{href:`#fig_${s}`,children:(0,t.jsxs)("span",{className:"bibRef",children:["Figure ",s]})})}function r(e){let{name:s,file:n}=e;Object.entries({sd:"softwaredesign",sa:"softwarearchitecture",cs:"computerscience"}).some((e=>{let[s,t]=e;if(n.startsWith(`${s}.`))return n=n.replace(`${s}.`,`${t}.`),!0}));const a=`/docs/toolbox/${n}`;return(0,t.jsx)("a",{href:a,className:"glosRef",children:s})}},5142:(e,s,n)=>{"use strict";n.d(s,{o:()=>a});n(6540);var t=n(4848);function a(){return(0,t.jsx)("div",{style:{width:"100%",textAlign:"right"},children:(0,t.jsx)("a",{style:{textDecoration:"underline"},onClick:()=>history.go(-1),href:"#",children:"Back"})})}},8453:(e,s,n)=>{"use strict";n.d(s,{R:()=>r,x:()=>l});var t=n(6540);const a={},i=t.createContext(a);function r(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);