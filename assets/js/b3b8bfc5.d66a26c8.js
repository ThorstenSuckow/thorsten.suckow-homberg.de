(self.webpackChunkthorsten_suckow_homberg_de=self.webpackChunkthorsten_suckow_homberg_de||[]).push([[9988],{477:()=>{},2172:(e,s,t)=>{"use strict";t.d(s,{$z:()=>m,C9:()=>d,IX:()=>u,ZX:()=>x,eJ:()=>h,uR:()=>p});var n=t(6540),a=t(4882),i=t(8069),r=t(4945),o=t.n(r),c=t(2897),l=(t(3271),t(4848));function d(e){let{width:s,children:t,title:n,figure:i,figref:r,modeAware:o}=e;return(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,l.jsxs)("div",{style:{maxWidth:s,textAlign:"center",margin:20},children:[r&&(0,l.jsx)("a",{name:`fig_${r}`}),(0,l.jsx)("div",{className:!1!==o?"umlImg":"",children:t}),(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsxs)("sup",{children:[(0,l.jsx)("b",{children:a.A.isString(i)?i:`Figure ${i??r??1}`})," ",(0,l.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})]})})]})})}function h(e){let{id:s,source:t,title:n}=e;return(0,l.jsx)(d,{modeAware:!1,title:n,figure:`Source ${t}`,children:(0,l.jsx)(c.A,{id:s})})}function m(e){let{url:s,figure:t,title:n}=e;return(0,l.jsx)(d,{modeAware:!1,figure:t,title:n,children:(0,l.jsx)("img",{alt:"{title}",src:s})})}function p(e){let{children:s,figure:t,title:n}=e;return(0,l.jsx)(d,{modeAware:!0,figure:t,title:n,children:s})}function x(e){let{when:s,where:t}=e;const[n,a]=t;return(0,l.jsxs)("div",{children:["This article was originally published in ",s," at ",(0,l.jsx)("a",{target:"_blank",href:a,children:n}),". Some formatting might have get lost during the migration to this site: If you think you spotted an issue caused by malformed formatting, feel free to open a ",(0,l.jsx)("a",{href:"https://github.com/ThorstenSuckow/thorsten.suckow-homberg.de",children:"Pull Request"})," or ",(0,l.jsx)("a",{href:"mailto:thorsten@suckow-homberg.de",children:"send me an Email"}),"."]})}function u(e){let{url:s}=e;const[t,a]=n.useState("");return o()(s).then((e=>{e.text().then((e=>a(e)))})),(0,l.jsx)(i.A,{language:"php",children:t})}},2667:(e,s,t)=>{"use strict";t.r(s),t.d(s,{assets:()=>m,bibRefs:()=>p,contentTitle:()=>h,default:()=>f,figures:()=>x,frontMatter:()=>d,metadata:()=>n,toc:()=>u});const n=JSON.parse('{"id":"wiki/csec.ipsec","title":"IPsec","description":"IPsec (IP security) is a protocol suite  for the network layer in the 5-layer internet model.","source":"@site/docs/wiki/csec.ipsec.mdx","sourceDirName":"wiki","slug":"/wiki/csec.ipsec","permalink":"/docs/wiki/csec.ipsec","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/thorsten.suckow-homberg.de/tree/main/docs/wiki/csec.ipsec.mdx","tags":[{"inline":true,"label":"information security","permalink":"/docs/tags/information-security"},{"inline":true,"label":"computer networks","permalink":"/docs/tags/computer-networks"}],"version":"current","lastUpdatedBy":"Thorsten Suckow-Homberg","lastUpdatedAt":1748086498000,"frontMatter":{"title":"IPsec","tags":["information security","computer networks"]},"sidebar":"wiki","previous":{"title":"Higher-Order Function","permalink":"/docs/wiki/computerscience.higherorderfunction"},"next":{"title":"ISO/IEC 27001","permalink":"/docs/wiki/csec.isoiec27001"}}');var a=t(4848),i=t(8453),r=(t(5142),t(3271)),o=t(2172);const c=t.p+"assets/images/transportmode-3a5c25da98cdec1a5f31d8b87f6e37f4.png",l=t.p+"assets/images/tunnelmode-c79186a6724450443e7562671bc6576f.png",d={title:"IPsec",tags:["information security","computer networks"]},h="IPsec (CSEC)",m={},p=["RFC4301","RFC6434","Gra17","SF12","TFW21","RFC4306","RFC4302","RFC4303","RFC2410"],x={transportmode:1,tunnelmode:2},u=[{value:"Authentication Header Protocol (AH)",id:"authentication-header-protocol-ah",level:2},{value:"Transport Mode",id:"transport-mode",level:3},{value:"Tunnel Mode",id:"tunnel-mode",level:3},{value:"Establishing Authenticity and Integrity with AH",id:"establishing-authenticity-and-integrity-with-ah",level:3},{value:"Encapsulating Security Payload Protocol (ESP)",id:"encapsulating-security-payload-protocol-esp",level:2},{value:"Transport Mode",id:"transport-mode-1",level:3},{value:"Tunnel Mode",id:"tunnel-mode-1",level:3},{value:"Combination of AH and ESP",id:"combination-of-ah-and-esp",level:3},{value:"Comparing IPsec to SSL/TLS",id:"comparing-ipsec-to-ssltls",level:2}];function j(e){const s={a:"a",annotation:"annotation",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msup:"msup",ol:"ol",p:"p",section:"section",semantics:"semantics",span:"span",strong:"strong",sup:"sup",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"ipsec-csec",children:"IPsec (CSEC)"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"IPsec"})," (",(0,a.jsx)(s.em,{children:"IP security)"})," is a protocol suite  for the network layer in the 5-layer internet model.\nIt provides  ",(0,a.jsx)(s.strong,{children:"confidentiality"}),", ",(0,a.jsx)(s.strong,{children:"integrity"})," and ",(0,a.jsx)(s.strong,{children:"authenticity"})," for IPv4/IPv6 traffic at the IP layer."]}),"\n",(0,a.jsxs)(s.p,{children:["IPsec can be understood as a framework rather than a single, self-contained protocol. Therefore, the specification spans various RFCs.\nAn architectural overview is given in ",(0,a.jsx)(r.E4,{name:"RFC4301"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["The original specification for IPv4 did not include native protection mechanisms. However, due to growing concerns about network security in the 1990s, the IETF intended to make security mechanisms mandatory for the upcoming IPv6",(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-ipsecwar",id:"user-content-fnref-ipsecwar","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),".\n",(0,a.jsx)(s.em,{children:"Graziani"})," points out that this mandate was later relaxed in ",(0,a.jsx)(r.E4,{name:"RFC6434"})," (",(0,a.jsx)(r.E4,{name:"Gra17",pp:"78"}),'): Support for IPsec is recommended ("',(0,a.jsx)(s.em,{children:"should"}),' implement") for IPv6 devices',(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-ipsecmust",id:"user-content-fnref-ipsecmust","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["There are two protocols commonly used with IPsec when end-to-end communications needs to be secured: The ",(0,a.jsx)(s.strong,{children:"Authentication Header Protocol"})," and the ",(0,a.jsx)(s.strong,{children:"Encapsulating Security Payload Protocol"}),", respectively. Both differ in the security objectives they achieve.\nFurthermore,"]}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:['"both AH and ESP offer integrity and authentication\nservices, but the coverage differs for each protocol and differs for\ntransport vs. tunnel mode." (',(0,a.jsx)(r.E4,{name:"RFC4301",add:"Section 4.2"}),")."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"The following provides a brief overview."}),"\n",(0,a.jsxs)(s.p,{children:["(Note that for IPsec to be used various parameter shave to be negotiated. This is realized with the help of ",(0,a.jsx)(s.strong,{children:"Security Associations"}),". The concept is described in ",(0,a.jsx)(r.E4,{name:"RFC4301",add:"Section 4.1"})," and ",(0,a.jsx)(r.E4,{name:"RFC4306"})," respectively.)"]}),"\n",(0,a.jsx)(s.h2,{id:"authentication-header-protocol-ah",children:"Authentication Header Protocol (AH)"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Authentication Header"})," is specified in  ",(0,a.jsx)(r.E4,{name:"RFC4302"}),". It is designed to provide origin authentication and integrity for IPv4- and IPv6-datagrams."]}),"\n",(0,a.jsx)(s.h3,{id:"transport-mode",children:"Transport Mode"}),"\n",(0,a.jsxs)(s.p,{children:["In ",(0,a.jsx)(s.em,{children:"transport mode"}),", an IPsec datagram gets created as follows: An HMAC ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mi,{children:"h"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"h"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"})]})})]})," is constructed over the payload of the IP datagram, i.e. the encapsulated TCP packet (",(0,a.jsx)(r.E4,{name:"TFW21",pp:"823"}),'), and over immutable fields of the IP header.\nThe result is prepended as the AH to the original payload of the datagram. It contains the cryptographic data used to verify the authenticity and integrity of the datagram by the destination host.\nThus, it the payload of the "new" datagram  (see ',(0,a.jsx)(r.Dn,{idx:x.transportmode}),") contains the original TCP packet and the AH."]}),"\n",(0,a.jsx)(s.p,{children:"The original IP header from the authenticated datagram is reused for sending the datagram."}),"\n",(0,a.jsxs)(s.p,{children:["The destination host recalculates the HMAC ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"h'"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.7519em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})})]})," over the payload of the datagram and specific fields of the IP header and compares it to the HMAC ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mi,{children:"h"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"h"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"})]})})]})," embedded in the Authentication Header.\nIf both values match, the datagram was verified."]}),"\n",(0,a.jsxs)(s.p,{children:["The symmetric key used for the HMAC was previously established via the negotiated ",(0,a.jsx)(s.strong,{children:"Security Association"})," and the implemented ",(0,a.jsx)(s.strong,{children:"Internet Key Exchange (IKEv2) Protocol"})," (",(0,a.jsx)(r.E4,{name:"RFC4306"}),")."]}),"\n",(0,a.jsx)(o.C9,{modeAware:!0,width:600,figref:x.transportmode,title:"Illustration of the IPsec Transport-Mode. Note that when using AH in transport mode, not all fields of the IP header are authenticated, since certain fields - such as the TTL or destination address - must be read or modified by devices not IPsec-aware.",children:(0,a.jsx)("img",{src:c})}),"\n",(0,a.jsx)(s.h3,{id:"tunnel-mode",children:"Tunnel Mode"}),"\n",(0,a.jsxs)(s.p,{children:["In tunnel mode, the ",(0,a.jsx)(s.strong,{children:"entire original IP datagram"})," is encapsulated and becomes the payload of a new datagram.\nAn HMAC is computed over this payload (see ",(0,a.jsx)(r.Dn,{idx:x.tunnelmode}),").",(0,a.jsx)("br",{}),"\nThe ",(0,a.jsx)(s.strong,{children:"outer IP header"})," is constructed independently, often by copying selected fields from the original header. However, since the HMAC does not cover fields from the outer header, intermediate network devices like router and switches may modify those fields if required (e.g. to support ",(0,a.jsx)(s.em,{children:"Network Address Translation"}),")."]}),"\n",(0,a.jsxs)(s.p,{children:["As a result, the verification process performed by the destination host excludes fields from the outer header, in contrast to ",(0,a.jsx)(s.strong,{children:"transport mode"}),"."]}),"\n",(0,a.jsx)(s.h3,{id:"establishing-authenticity-and-integrity-with-ah",children:"Establishing Authenticity and Integrity with AH"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Integrity"})," is ensured by verifying whether ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mo,{children:(0,a.jsxs)(s.mover,{children:[(0,a.jsx)(s.mo,{children:(0,a.jsx)(s.mo,{children:"="})}),(0,a.jsx)(s.mo,{stretchy:"false",lspace:"0em",rspace:"0em",children:"?"})]})}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"h \\overset{?}{=} h'"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1.153em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:(0,a.jsx)(s.span,{className:"mop op-limits",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.153em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{className:"mop",children:"="})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.5669em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mclose mtight",children:"?"})})})]})]})})})})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.7519em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})]})]}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Authenticity"})," is guaranteed by the fact that only sender and receiver possess the secret shared by using the ",(0,a.jsx)(s.strong,{children:"Security Association"})," and negotiated over the ",(0,a.jsx)(s.strong,{children:"IKE Protocol"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["If verification of ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mo,{children:(0,a.jsxs)(s.mover,{children:[(0,a.jsx)(s.mo,{children:(0,a.jsx)(s.mo,{children:"="})}),(0,a.jsx)(s.mo,{stretchy:"false",lspace:"0em",rspace:"0em",children:"?"})]})}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mo,{mathvariant:"normal",lspace:"0em",rspace:"0em",children:"\u2032"})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"h \\overset{?}{=} h'"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1.153em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:(0,a.jsx)(s.span,{className:"mop op-limits",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.153em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{className:"mop",children:"="})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.5669em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mclose mtight",children:"?"})})})]})]})})})})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.7519em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"h"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032"})})})]})})})})})]})]})]})]})," fails, then the datagram cannot be trusted."]}),"\n",(0,a.jsx)(s.h2,{id:"encapsulating-security-payload-protocol-esp",children:"Encapsulating Security Payload Protocol (ESP)"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Encapsulating Security Payload Protocol"})," (_ESP) is specified in ",(0,a.jsx)(r.E4,{name:"RFC4303"}),". In addition to ",(0,a.jsx)(s.a,{href:"#authentication-header-protocol-ah",children:"AH"}),", it provides confidentiality.\n",(0,a.jsx)(s.em,{children:"Fall and Stevens"})," point out that, if ESP is used, but only authenticity and integrity if required, ESP can employ a ",(0,a.jsx)(s.code,{children:"NULL"}),"-encryption method[^null-encryption] (",(0,a.jsx)(r.E4,{name:"SF12",pp:"858"}),")."]}),"\n",(0,a.jsxs)(s.p,{children:["[^null-encryption] ",(0,a.jsx)(r.E4,{name:"RFC2410"})]}),"\n",(0,a.jsx)(s.h3,{id:"transport-mode-1",children:"Transport Mode"}),"\n",(0,a.jsxs)(s.p,{children:["In ",(0,a.jsx)(s.strong,{children:"transport mode"}),", ESP encrypts the TCP packet. In contrast to AH, the HMAC for integrity check is ",(0,a.jsx)(s.em,{children:"appended"})," to the encrypted payload, after the  ",(0,a.jsx)(s.strong,{children:"ESP trailer"}),", which contains ",(0,a.jsx)(s.em,{children:"Pad"}),", ",(0,a.jsx)(s.em,{children:"Pad Length"})," and ",(0,a.jsx)(s.em,{children:"Next Header"})," fields (see ",(0,a.jsx)(r.Dn,{idx:x.transportmode}),")."]}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:['"The ESP ICV is a variable-length trailer used if integrity support is enabled\nand required by the integrity-checking algorithm. It is computed over the ESP\nheader, payload, and ESP trailer." ',(0,a.jsx)(r.E4,{name:"SF12",pp:"859"})]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"tunnel-mode-1",children:"Tunnel Mode"}),"\n",(0,a.jsxs)(s.p,{children:["In ",(0,a.jsx)(s.strong,{children:"tunnel mode"}),", ESP encrypts the whole original IP datagram. Just like with AH and tunnel mode, a new IP header is then constructed, and intermediate devices may modify the header fields as required (see ",(0,a.jsx)(r.Dn,{idx:x.tunnelmode}),")."]}),"\n",(0,a.jsx)(o.C9,{modeAware:!0,width:600,figref:x.tunnelmode,title:"IPsec Tunnel-Mode.",children:(0,a.jsx)("img",{src:l})}),"\n",(0,a.jsx)(s.h3,{id:"combination-of-ah-and-esp",children:"Combination of AH and ESP"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.em,{children:"Tanenbaum et al."})," point out that AH's integrity check uses some of the IP header's fields, which makes it \"impossible for an intruder to falsify the origin of a packet\". (",(0,a.jsx)(r.E4,{name:"TFW21",pp:"823"}),")",(0,a.jsx)(s.sup,{children:(0,a.jsx)(s.a,{href:"#user-content-fn-ahesphist",id:"user-content-fnref-ahesphist","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})}),".\nFor this reason, AH and ESP are sometimes combined to add an additional layer of protection:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"AH first, then ESP: The AH data is encrypted. The origin is only visible to the receiving peer after decryption."}),"\n",(0,a.jsx)(s.li,{children:"ESP first, then AH: AH covers the encrypted payload, providing a stronger form for origin authenticity."}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"comparing-ipsec-to-ssltls",children:"Comparing IPsec to SSL/TLS"}),"\n",(0,a.jsxs)(s.p,{children:["While ",(0,a.jsx)(r.lA,{name:"SSL/TLS",file:"computernetworks.ssltls"})," operates as an application-layer protocol, IPsec secures end-to-end communication at the network-layer."]}),"\n",(0,a.jsx)(s.p,{children:"Support for SLS/TLS must be provided by the applications that wish to provide secure communications, e.g. web browsers or mail clients."}),"\n",(0,a.jsx)(s.p,{children:"In contrast, IPsec is implemented at a lower abstraction layer in the IP stack and requires system wide support, affecting devices and operating systems.\nFor example, when tunnel mode is used, receiving endpoints must be able to properly demultiplex incoming packets and extract the payload accordingly."}),"\n",(0,a.jsxs)(s.p,{children:["Due to the (architectural) complexity of IPsec, it is most commonly deployed in ",(0,a.jsx)(s.strong,{children:"Virtual Private Networks"})," (",(0,a.jsx)(s.em,{children:"VPNs"}),")."]}),"\n",(0,a.jsx)(s.hr,{}),"\n","\n",(0,a.jsxs)(s.section,{"data-footnotes":!0,className:"footnotes",children:[(0,a.jsx)(s.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{id:"user-content-fn-ipsecwar",children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.em,{children:"Tanenbaum"})," outlines briefly the historical discussion that led to IPsec being addressed at the network layer instead of relying on application layer protocols in ",(0,a.jsx)(r.E4,{name:"TFW21",pp:"820"})," ",(0,a.jsx)(s.a,{href:"#user-content-fnref-ipsecwar","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{id:"user-content-fn-ipsecmust",children:["\n",(0,a.jsxs)(s.p,{children:['"Previously, IPv6 mandated implementation of IPsec and recommended the\nkey management approach of IKE.  This document updates that\nrecommendation by making support of the IPsec Architecture [RFC4301]\na SHOULD for all IPv6 nodes." (',(0,a.jsx)(r.E4,{name:"RFC6434",add:"Section 11"}),"). Conversely, ",(0,a.jsx)(s.em,{children:"Fall and Stevens"})," state in  ",(0,a.jsx)(r.E4,{name:"SF12",pp:"841"})," that IPsec implementation must be present fpr IPv6 implementations, which is possibly due to the close date of the pblication date of the 2nd edition of this book (2012) and the RFC's publication date (December 2011) ",(0,a.jsx)(s.a,{href:"#user-content-fnref-ipsecmust","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{id:"user-content-fn-ahesphist",children:["\n",(0,a.jsxs)(s.p,{children:["Additionally, the authors mention the historical motivation for the existence of the two different protocols: AH was responsible for integrity, ESP for encryption, while integrity was later on added to ESP (",(0,a.jsx)(s.em,{children:"ibid."}),", p. ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mn,{children:"824"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"824"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"824"})]})})]}),"). ",(0,a.jsx)(s.a,{href:"#user-content-fnref-ahesphist","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function f(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(j,{...e})}):j(e)}},3271:(e,s,t)=>{"use strict";t.d(s,{R5:()=>a,I8:()=>a,Dn:()=>i,lA:()=>r,E4:()=>a,$1:()=>r});t(6540);var n=t(4848);function a(e){let{name:s,pp:t,add:a}=e;const i=`#bibref-${s.toLowerCase()}`;return(0,n.jsxs)("a",{href:i,children:["[",(0,n.jsxs)("span",{className:"bibRef",children:["\ud83d\udcd6",s]}),a?`, ${a} `:"",t?`, ${t.includes("-")?"pp":"p"}. ${t}`:"","]"]})}function i(e){let{idx:s}=e;return(0,n.jsx)("a",{href:`#fig_${s}`,children:(0,n.jsxs)("span",{className:"bibRef",children:["Figure ",s]})})}function r(e){let{name:s,file:t,url:a}=e;t=t||(a||""),Object.entries({sd:"softwaredesign",sa:"softwarearchitecture",cs:"computerscience"}).some((e=>{let[s,n]=e;if(t.startsWith(`${s}.`))return t=t.replace(`${s}.`,`${n}.`),!0}));const i=`/docs/wiki/${t}`;return(0,n.jsx)("a",{href:i,className:"glosRef",children:s})}},5142:(e,s,t)=>{"use strict";t.d(s,{o:()=>a});t(6540);var n=t(4848);function a(){return(0,n.jsx)("div",{style:{width:"100%",textAlign:"right"},children:(0,n.jsx)("a",{style:{textDecoration:"underline"},onClick:()=>history.go(-1),href:"#",children:"Back"})})}},8453:(e,s,t)=>{"use strict";t.d(s,{R:()=>r,x:()=>o});var n=t(6540);const a={},i=n.createContext(a);function r(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);